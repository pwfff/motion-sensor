<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</variable><variable id="pXO4-3GhV/DhbYH(zi}B">current_acceleration</variable><variable id="]aiOE;OibHdb15;d0w=S">average_acceleration</variable><variable id="lbV^I`iHdE/=qWp}G`(d">value</variable><variable id="hf3?U-TzcU[~Wibdo3eR">number_of_accelerations</variable><variable id="W_3QoI*HSo^XNzhws%~$">total</variable><variable id="PT.Z_$MGD#:0@:yRABt:">sensitivity</variable><variable id="{{`]|?2aT1[a}ZM%/rsW">list</variable><variable id="I8Bkkeihwpp)V,9:f2M#">absolute_magnitude</variable></variables><block type="pxt-on-start" id="8CV(/#ue]6EMB77_kWDS" x="1" y="-242"><comment>Here we initialize some settings and variables we're going to use later on.</comment><statement name="HANDLER"><block type="device_set_accelerometer_range" id="fvzkGz-brULm1RUA$7cx"><field name="range">AcceleratorRange.EightG</field><comment>This tells the micro:bit we want to detect large-ish movements.</comment><next><block type="variables_set" id="+Jrd(:0rp7qw/*=^^@iE"><field name="VAR" id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</field><comment>This list will keep the last 10 measurements, so we can average them out and get an idea of what 'normal' acceleration is.</comment><value name="VALUE"><block type="lists_create_with" id="6g9vWcH8IW{W(~o{71OD"><mutation items="1" horizontalafter="3"/><value name="ADD0"><shadow type="math_number"><field name="NUM">1023</field></shadow><block type="device_acceleration" id="V`e?um4EsfI%AtVOCK3N"><field name="NAME">Dimension.Strength</field></block></value></block></value><next><block type="variables_set" id="lK*9oN6Y;RU;0J6]A!J|"><field name="VAR" id="PT.Z_$MGD#:0@:yRABt:">sensitivity</field><comment>This is used later on to compare to the current acceleration to the average, to make it less sensitive. The smaller the number is, the more sensitive it is! Just sitting on a table it would have a difference of about 100, so anything larger than that should work.</comment><value name="VALUE"><shadow type="math_number" id="W7pq#C=cGbcEW?t!*L}B"><field name="NUM">200</field></shadow></value></block></next></block></next></block></statement></block><block type="function_definition" id="6JB*rU*kIy5ZA[:+Pi9n" x="0" y="0"><mutation name="alarm" functionid="X+jD_Mr~AtFTU@sDfRbl"/><field name="function_name">alarm</field><comment>Change this to change what happens when the alarm goes off!</comment><statement name="STACK"><block type="controls_repeat_ext" id="-x`DsbYy7`*I~XP%qz4Q"><value name="TIMES"><shadow type="math_whole_number" id="?g4TM.!9R[r0MVI]gc3T"><field name="NUM">3</field></shadow></value><statement name="DO"><block type="SoundExpression_playUntilDone" id="9bcD}N9hB7G)!Z:)lB6U"><field name="this">soundExpression.hello</field></block></statement></block></statement></block><block type="control_on_event" id="7I^Ww0cV~a9I+~}oa3(p" x="-5" y="244"><comment>This an 'event', set to run code when the accelerometer has new data for us. We can put the same blocks in 'run forever' too, but this *might* be a little better for the battery since it won't run as often.</comment><value name="src"><shadow type="control_event_source_id" id="!Q4ZWbgk?decWJXcV2JD"><field name="id">EventBusSource.MICROBIT_ID_ACCELEROMETER</field></shadow></value><value name="value"><shadow type="control_event_value_id" id="_mq(!*_m?t,W[XfPw=T6"><field name="id">EventBusValue.MICROBIT_ACCELEROMETER_EVT_DATA_UPDATE</field></shadow></value><statement name="HANDLER"><block type="variables_set" id="@`x$l0~p{ue`7-4y*zK]"><field name="VAR" id="pXO4-3GhV/DhbYH(zi}B">current_acceleration</field><comment>First, we gotta get the current acceleration.</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_acceleration" id="5Ry?wXg$94|6rHA_V28T"><field name="NAME">Dimension.Strength</field></block></value><next><block type="variables_set" id="mC~O`-Sq26bG4uOld`xJ"><field name="VAR" id="]aiOE;OibHdb15;d0w=S">average_acceleration</field><comment>Then, we get the average of the last 10 samples, to see if we're moving in a different direction than before.</comment><value name="VALUE"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="function_call_output" id="oi|#SjUHLN[ZM:[KhS$p"><mutation name="get_average_acceleration" functionid="B0a=s0lhlNlAf!+RM2cm"><arg name="list" id="A+|=;cr$Hy%]v/p}8VV@" type="Array"/></mutation><value name="A+|=;cr$Hy%]v/p}8VV@"><shadow type="variables_get" id="ba25^UjmwFMkydnC227]"><field name="VAR" id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</field></shadow></value></block></value><next><block type="variables_set" id="|}=IJ)*$Pvg#0x~cbr@Z"><field name="VAR" id="I8Bkkeihwpp)V,9:f2M#">absolute_magnitude</field><comment>This math tells us the difference between our average and the current value. The absolute is used because we care about negative directions too!</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_op3" id="Iv8{C?TbL(o^Lm;(j#e_"><value name="x"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="WEe1:XeEh%.,)8r!i:6+"><field name="OP">MINUS</field><value name="A"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="pbY$ronkkEw(O15d:/Gn"><field name="VAR" id="pXO4-3GhV/DhbYH(zi}B">current_acceleration</field></block></value><value name="B"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="OmM#q:@#-vKSB[-BfhXc"><field name="VAR" id="]aiOE;OibHdb15;d0w=S">average_acceleration</field></block></value></block></value></block></value><next><block type="device_plot_bar_graph" id="eL!BEQcug+5d0yq._rU."><comment>I used this plot to help 'debug' the code. It's hard to fix things when you don't know what the values actually are!</comment><value name="value"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="3aL+nElSm(TfzXrQj6oJ"><field name="VAR" id="I8Bkkeihwpp)V,9:f2M#">absolute_magnitude</field></block></value><value name="high"><shadow type="math_number"><field name="NUM">1023</field></shadow><block type="variables_get" id="vAS;Q*CHe})hE,#KJ`]@"><field name="VAR" id="PT.Z_$MGD#:0@:yRABt:">sensitivity</field></block></value><next><block type="function_call" id="486z%fV|i0CeB:`%_*g5"><mutation name="update_list" functionid="*B4S6ljABJ#Q-oK8$STm"><arg name="list" id="IJPQ0Rt8JNV1UpMY#EI8" type="Array"/><arg name="num" id="`x`wH,m[Y(!:Ae}N}VU`" type="number"/></mutation><comment>This function updates the list we use for our average, and makes sure it doesn't get too big.</comment><value name="IJPQ0Rt8JNV1UpMY#EI8"><shadow type="variables_get" id="?d?/N4J6pv!}J7*,EcyL"><field name="VAR" id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</field></shadow></value><value name="`x`wH,m[Y(!:Ae}N}VU`"><shadow type="math_number" id="aWFY4[69J-fh8Bg-?5aW"><field name="NUM">1</field></shadow><block type="variables_get" id="T4li|)}VQ-#m`@No^S?x"><field name="VAR" id="pXO4-3GhV/DhbYH(zi}B">current_acceleration</field></block></value><next><block type="controls_if" id="]+#}{T8FgfVm~ow{5=*."><comment>Finally, we check what our magnitude is and if it's higher than our sensitivity, we raise the alarm! </comment><value name="IF0"><shadow type="logic_boolean" disabled="true"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="l*5xGf|xe^Nz=XDy=oQr"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="CK+wOgau$-,3tMk_Vvse"><field name="VAR" id="I8Bkkeihwpp)V,9:f2M#">absolute_magnitude</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="N{smBQpC@_ARD%A`tOLw"><field name="VAR" id="PT.Z_$MGD#:0@:yRABt:">sensitivity</field></block></value></block></value><statement name="DO0"><block type="function_call" id="A0?-hr#8#~DXWFl0mUQ`"><mutation name="alarm" functionid="X+jD_Mr~AtFTU@sDfRbl"/><next><block type="variables_set" id=".zeQ/_b!4`i}I#86s{K1"><field name="VAR" id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</field><value name="VALUE"><block type="lists_create_with" id="}EeDNIr!B*JpgwG,h:)B"><mutation items="1" horizontalafter="3"/><value name="ADD0"><shadow type="math_number"><field name="NUM">1023</field></shadow><block type="device_acceleration" id="9;!{RkL0@=)eQ,0F`J$4"><field name="NAME">Dimension.Strength</field></block></value></block></value></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="#X#37j:Tk*Du1~]Gsqan" x="-3" y="836"><mutation name="update_list" functionid="*B4S6ljABJ#Q-oK8$STm"><arg name="list" id="IJPQ0Rt8JNV1UpMY#EI8" type="Array"/><arg name="num" id="`x`wH,m[Y(!:Ae}N}VU`" type="number"/></mutation><field name="function_name">update_list</field><statement name="STACK"><block type="array_push" id="4jav%MQ*`I0.PwWI1Muh"><value name="list"><block type="argument_reporter_array" id="T!AJ7a5v`rE%[:vz$h(["><field name="VALUE">list</field></block></value><value name="value"><block type="argument_reporter_number" id="po3NOweJG*P;-KV]}EZE"><field name="VALUE">num</field></block></value><next><block type="controls_if" id="Hs2;bDS2P/p=rKbotY2D"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="C8z|2_?mRUH!FB2e={h;"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_length" id="1DrokY6)*h)aZ7T#hCZn"><value name="VALUE"><block type="argument_reporter_array" id="Pt(Cuj6@~heO3[FAx4e%"><field name="VALUE">list</field></block></value></block></value><value name="B"><shadow type="math_number" id=".=ja?xfM,?c?M?_a~=_W"><field name="NUM">10</field></shadow></value></block></value><statement name="DO0"><block type="array_shift_statement" id="cgAAP[ZWna$|2;+F|`K0"><value name="list"><block type="argument_reporter_array" id=".g7qDvy+~$prtnaSXccD"><field name="VALUE">list</field></block></value></block></statement></block></next></block></statement></block><block type="function_definition" id="XC+%khf0q!f[lQ/Za.:3" x="-2" y="1130"><mutation name="get_average_acceleration" functionid="B0a=s0lhlNlAf!+RM2cm"><arg name="list" id="A+|=;cr$Hy%]v/p}8VV@" type="Array"/></mutation><field name="function_name">get_average_acceleration</field><statement name="STACK"><block type="variables_set" id="vDD+=^lG?,jsm@xEQkFL"><field name="VAR" id="hf3?U-TzcU[~Wibdo3eR">number_of_accelerations</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_length" id="||g/AYOu@pz;jxel6kl4"><value name="VALUE"><block type="variables_get" id="jikKhyZ]fnO`_$Hg{re="><field name="VAR" id="Eawz2]oNd:k,6xGjYHiK">previous_accelerations</field></block></value></block></value><next><block type="variables_set" id="+{6yC|Lm%]!^q3#vT$~f"><field name="VAR" id="W_3QoI*HSo^XNzhws%~$">total</field><value name="VALUE"><shadow type="math_number" id="frlpD-;/(hEoi)BJ=Kp8"><field name="NUM">0</field></shadow></value><next><block type="pxt_controls_for_of" id="P=893ef|P5CV*:un)K6G"><value name="VAR"><shadow type="variables_get_reporter" id="3lR?A7k}p=i8E~z30ltC"><field name="VAR" id="lbV^I`iHdE/=qWp}G`(d">value</field></shadow></value><value name="LIST"><shadow type="variables_get"><field name="VAR" id="?m:3FRrCKn@;qll4W|/x">list</field></shadow><block type="argument_reporter_array" id="(n;mLd2lSGk+SsA,pBrO"><field name="VALUE">list</field></block></value><statement name="DO"><block type="variables_set" id="m]a,Y~[?;ns/@.:+]~6?"><field name="VAR" id="W_3QoI*HSo^XNzhws%~$">total</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="9bYFSFP%tXiyN%a|%H!@"><field name="OP">ADD</field><value name="A"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="WPCSaXy-dxXO%umpCB2*"><field name="VAR" id="W_3QoI*HSo^XNzhws%~$">total</field></block></value><value name="B"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="G;9Dd{2.$2,!NHH6e`rv"><field name="VAR" id="lbV^I`iHdE/=qWp}G`(d">value</field></block></value></block></value></block></statement><next><block type="function_return" id="ha#;*o;M@aj5.FH{fYT|"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="rv.+aGLLCv1s~giyZ!uz"><field name="OP">DIVIDE</field><value name="A"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="fBS-/?pD=LgP9]Z+jdP~"><field name="VAR" id="W_3QoI*HSo^XNzhws%~$">total</field></block></value><value name="B"><shadow type="math_number" disabled="true"><field name="NUM">0</field></shadow><block type="variables_get" id="}nQ@s)f.WoW8eqb!/464"><field name="VAR" id="hf3?U-TzcU[~Wibdo3eR">number_of_accelerations</field></block></value></block></value></block></next></block></next></block></next></block></statement></block></xml>